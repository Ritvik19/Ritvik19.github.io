<!DOCTYPE html>
<!--[if lt IE 7]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <meta name="keywords" content="" />

    <title>pyradox-generative</title>

    <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon" />

    <link rel="stylesheet" type="text/css" href="../fonts/font-awesome-4.3.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/stroke.css" />
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../css/animate.css" />
    <link rel="stylesheet" type="text/css" href="../css/prettyPhoto.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />

    <link rel="stylesheet" type="text/css" href="../js/syntax-highlighter/styles/shCore.css" media="all" />
    <link rel="stylesheet" type="text/css" href="../js/syntax-highlighter/styles/shThemeRDark.css" media="all" />

    <!-- CUSTOM -->
    <link rel="stylesheet" type="text/css" href="../css/custom.css" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <button onclick="topFunction()" id="myBtn" title="Go to top">
      <i class="fa fa-chevron-up" aria-hidden="true"></i>
    </button>

    <script>
        var mybutton = document.getElementById("myBtn");
        window.onscroll = function() {
            scrollFunction();
        };

        function scrollFunction() {
            if (
                document.body.scrollTop > 1000 ||
                document.documentElement.scrollTop > 1000
            ) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }

        function topFunction() {
            window.scrollTo({
                top: 0,
                behavior: "smooth",
            });
            document.documentElement.scrollTo({
                top: 0,
                behavior: "smooth",
            });
        }

        document.addEventListener("DOMContentLoaded", () => {
            document.querySelector("#mode").addEventListener("click", () => {
                document.querySelector("html").classList.toggle("dark");
            });
        });
    </script>

    <div id="wrapper">
        <div id="mode">
            <div class="dark">
                <svg aria-hidden="true" viewBox="0 0 512 512">
            <title>lightmode</title>
            <path
              fill="currentColor"
              d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"
            ></path>
          </svg>
            </div>
            <div class="light">
                <svg aria-hidden="true" viewBox="0 0 512 512">
            <title>darkmode</title>
            <path
              fill="currentColor"
              d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"
            ></path>
          </svg>
            </div>
        </div>

        <div class="container">
            <section id="top" class="section docs-heading">
                <div class="row">
                    <div class="col-md-12">
                        <div class="big-title text-center">
                            <h1>pyradox-generative</h1>
                            <p class="lead">
                                State of the Art Neural Networks for Generative Deep Learning
                            </p>
                        </div>
                        <!-- end title -->
                    </div>
                    <!-- end 12 -->
                </div>
                <!-- end row -->

                <hr />
            </section>
            <!-- end section -->

            <div class="row">
                <div class="col-md-3">
                    <nav class="docs-sidebar" data-spy="affix" data-offset-top="300" data-offset-bottom="200" role="navigation">
                        <ul class="nav">
                            <li><a href="#line1">Installation</a></li>
                            <li>
                                <a href="#line2">Usage</a>
                                <ul class="nav">
                                    <li><a href="#line2_1">Vanilla GAN</a></li>
                                    <li><a href="#line2_2">Conditional GAN</a></li>
                                    <li><a href="#line2_3">Wasserstein GAN</a></li>
                                    <li><a href="#line2_4">Variational Auto Encoder</a></li>
                                    <li><a href="#line2_5">Style GAN</a></li>
                                    <li><a href="#line2_6">Cycle GAN</a></li>
                                </ul>
                            </li>
                            <li><a href="#line3">References</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-md-9">
                    <section class="welcome">
                        <div class="row">
                            <div class="col-md-12 left-align">
                                <div class="row">
                                    <div class="col-md-12 full">
                                        <div>
                                            <p class="lead">
                                                This Library Provides Light Weight Trainers For The State Of The Art Generative Neural Networks Using A TensorFlow Backend
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <!-- end row -->
                            </div>
                        </div>
                    </section>

                    <section id="line1" class="section">
                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">
                                    Installation
                                    <hr />
                                </h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-12">
                                <pre class="brush: python;">
pip install pyradox-generative</pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
            </section>
            <!-- end section -->

            <section id="line2" class="section">
              <div class="row">
                <div class="col-md-12 left-align">
                  <h2 class="dark-text">
                    Usage
                    <hr />
                  </h2>
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->

              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_1">Vanilla GAN</h4>
                  <p>
                    Just provide your genrator and discriminator and train your
                    GAN
                    <br />
                    Data Preparation:
                  </p>
                  <pre class="brush: python;">
                    from pyradox_generative import GAN
                    import numpy as np
                    import tensorflow as tf
                    import tensorflow.keras as keras

                    (x_train, y_train), _ = keras.datasets.mnist.load_data()
                    x_train = x_train.astype(np.float32) / 255
                    x_train = x_train.reshape(-1, 28, 28, 1) * 2.0 - 1.0

                    dataset = tf.data.Dataset.from_tensor_slices(x_train)
                    dataset = dataset.shuffle(1024)
                    dataset = dataset.batch(32, drop_remainder=True).prefetch(1)
                  </pre>
                                <p>Define the generator and discriminator models:</p>
                                <pre class="brush: python;">
                    generator = keras.models.Sequential(
                        [
                            keras.Input(shape=[28]),
                            keras.layers.Dense(7 * 7 * 3),
                            keras.layers.Reshape([7, 7, 3]),
                            keras.layers.BatchNormalization(),
                            keras.layers.Conv2DTranspose(
                                32, kernel_size=3, strides=2, padding="same", activation="selu"
                            ),
                            keras.layers.Conv2DTranspose(
                                1, kernel_size=3, strides=2, padding="same", activation="tanh"
                            ),
                        ],
                        name="generator",
                    )

                    discriminator = keras.models.Sequential(
                        [
                            keras.layers.Conv2D(
                                32,
                                kernel_size=3,
                                strides=2,
                                padding="same",
                                activation=keras.layers.LeakyReLU(0.2),
                                input_shape=[28, 28, 1],
                            ),
                            keras.layers.Conv2D(
                                3,
                                kernel_size=3,
                                strides=2,
                                padding="same",
                                activation=keras.layers.LeakyReLU(0.2),
                            ),
                            keras.layers.Flatten(),
                            keras.layers.Dense(1, activation="sigmoid"),
                        ],
                        name="discriminator",
                    )
                  </pre>
                                <p>
                                    Plug in the models to the trainer class and train them using the very familiar compile and fit methods:
                                </p>
                                <pre class="brush: python;">
                                    gan = GAN(discriminator=discriminator, generator=generator, latent_dim=28)
                                    gan.compile(
                                        d_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                                        g_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                                        loss_fn=keras.losses.BinaryCrossentropy(),
                                    )

                                    history = gan.fit(dataset)
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_2">Conditional GAN</h4>
                  <p>
                    Just provide your genrator and discriminator and train your
                    GAN
                    <br />
                    Data Preparation and calculate the input and output
                    dimensions of generator and discriminator:
                  </p>
                  <pre class="brush: python;">
                    from pyradox_generative import ConditionalGAN
                    import numpy as np
                    import tensorflow as tf
                    import tensorflow.keras as keras

                    CODINGS_SIZE = 28
                    N_CHANNELS = 1
                    N_CLASSES = 10
                    G_INP_CHANNELS = CODINGS_SIZE + N_CLASSES
                    D_INP_CHANNELS = N_CHANNELS + N_CLASSES

                    (x_train, y_train), _ = keras.datasets.mnist.load_data()
                    x_train = x_train
                    x_train = x_train.astype(np.float32) / 255
                    x_train = x_train.reshape(-1, 28, 28, 1) * 2.0 - 1.0
                    y_train = y_train
                    y_train = keras.utils.to_categorical(y_train, 10)

                    dataset = tf.data.Dataset.from_tensor_slices((x_train, y_train))
                    dataset = dataset.shuffle(1024)
                    dataset = dataset.batch(32, drop_remainder=True).prefetch(1)
                  </pre>
                                <p>Define the generator and discriminator models:</p>
                                <pre class="brush: python;">
                                    generator = keras.models.Sequential(
                                        [
                                            keras.Input(shape=[G_INP_CHANNELS]),
                                            keras.layers.Dense(7 * 7 * 3),
                                            keras.layers.Reshape([7, 7, 3]),
                                            keras.layers.BatchNormalization(),
                                            keras.layers.Conv2DTranspose(
                                                32, kernel_size=3, strides=2, padding="same", activation="selu"
                                            ),
                                            keras.layers.Conv2DTranspose(
                                                1, kernel_size=3, strides=2, padding="same", activation="tanh"
                                            ),
                                        ],
                                        name="generator",
                                    )

                                    discriminator = keras.models.Sequential(
                                        [
                                            keras.layers.Conv2D(
                                                32,
                                                kernel_size=3,
                                                strides=2,
                                                padding="same",
                                                activation=keras.layers.LeakyReLU(0.2),
                                                input_shape=[28, 28, D_INP_CHANNELS],
                                            ),
                                            keras.layers.Conv2D(
                                                3,
                                                kernel_size=3,
                                                strides=2,
                                                padding="same",
                                                activation=keras.layers.LeakyReLU(0.2),
                                            ),
                                            keras.layers.Flatten(),
                                            keras.layers.Dense(1, activation="sigmoid"),
                                        ],
                                        name="discriminator",
                                    )
                  </pre>
                                <p>
                                    Plug in the models to the trainer class and train them using the very familiar compile and fit methods:
                                </p>
                                <pre class="brush: python;">
                                    gan = ConditionalGAN(
                                        discriminator=discriminator, generator=generator, latent_dim=CODINGS_SIZE
                                    )
                                    gan.compile(
                                        d_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                                        g_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                                        loss_fn=keras.losses.BinaryCrossentropy(),
                                    )

                                    history = gan.fit(dataset)
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_3">Wasserstein GAN</h4>
                  <p>
                    Just provide your genrator and discriminator and train your
                    GAN
                    <br />
                    Data Preparation:
                  </p>
                  <pre class="brush: python;">
                    from pyradox_generative import WGANGP
                    import numpy as np
                    import tensorflow as tf
                    import tensorflow.keras as keras

                    (x_train, y_train), _ = keras.datasets.mnist.load_data()
                    x_train = x_train.astype(np.float32) / 255
                    x_train = x_train.reshape(-1, 28, 28, 1) * 2.0 - 1.0

                    dataset = tf.data.Dataset.from_tensor_slices(x_train)
                    dataset = dataset.shuffle(1024)
                    dataset = dataset.batch(32, drop_remainder=True).prefetch(1)
                  </pre>
                                <p>Define the generator and discriminator models:</p>
                                <pre class="brush: python;">
                    generator = keras.models.Sequential(
                        [
                            keras.Input(shape=[28]),
                            keras.layers.Dense(7 * 7 * 3),
                            keras.layers.Reshape([7, 7, 3]),
                            keras.layers.BatchNormalization(),
                            keras.layers.Conv2DTranspose(
                                32, kernel_size=3, strides=2, padding="same", activation="selu"
                            ),
                            keras.layers.Conv2DTranspose(
                                1, kernel_size=3, strides=2, padding="same", activation="tanh"
                            ),
                        ],
                        name="generator",
                    )

                    discriminator = keras.models.Sequential(
                        [
                            keras.layers.Conv2D(
                                32,
                                kernel_size=3,
                                strides=2,
                                padding="same",
                                activation=keras.layers.LeakyReLU(0.2),
                                input_shape=[28, 28, 1],
                            ),
                            keras.layers.Conv2D(
                                3,
                                kernel_size=3,
                                strides=2,
                                padding="same",
                                activation=keras.layers.LeakyReLU(0.2),
                            ),
                            keras.layers.Flatten(),
                            keras.layers.Dense(1, activation="sigmoid"),
                        ],
                        name="discriminator",
                    )
                  </pre>
                                <p>
                                    Plug in the models to the trainer class and train them using the very familiar compile and fit methods:
                                </p>
                                <pre class="brush: python;">
                    gan = WGANGP(
                        discriminator=discriminator,
                        generator=generator,
                        latent_dim=28,
                        discriminator_extra_steps=1,
                        gp_weight=10,
                    )
                    gan.compile(
                        d_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                        g_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                    )

                    history = gan.fit(dataset)
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_2">Conditional GAN</h4>
                  <p>
                    Just provide your genrator and discriminator and train your
                    GAN
                    <br />
                    Data Preparation and calculate the input and output
                    dimensions of generator and discriminator:
                  </p>
                  <pre class="brush: python;">
                    from pyradox_generative import ConditionalGAN
                    import numpy as np
                    import tensorflow as tf
                    import tensorflow.keras as keras

                    CODINGS_SIZE = 28
                    N_CHANNELS = 1
                    N_CLASSES = 10
                    G_INP_CHANNELS = CODINGS_SIZE + N_CLASSES
                    D_INP_CHANNELS = N_CHANNELS + N_CLASSES

                    (x_train, y_train), _ = keras.datasets.mnist.load_data()
                    x_train = x_train
                    x_train = x_train.astype(np.float32) / 255
                    x_train = x_train.reshape(-1, 28, 28, 1) * 2.0 - 1.0
                    y_train = y_train
                    y_train = keras.utils.to_categorical(y_train, 10)

                    dataset = tf.data.Dataset.from_tensor_slices((x_train, y_train))
                    dataset = dataset.shuffle(1024)
                    dataset = dataset.batch(32, drop_remainder=True).prefetch(1)
                  </pre>
                                <p>Define the generator and discriminator models:</p>
                                <pre class="brush: python;">
                                    generator = keras.models.Sequential(
                                        [
                                            keras.Input(shape=[G_INP_CHANNELS]),
                                            keras.layers.Dense(7 * 7 * 3),
                                            keras.layers.Reshape([7, 7, 3]),
                                            keras.layers.BatchNormalization(),
                                            keras.layers.Conv2DTranspose(
                                                32, kernel_size=3, strides=2, padding="same", activation="selu"
                                            ),
                                            keras.layers.Conv2DTranspose(
                                                1, kernel_size=3, strides=2, padding="same", activation="tanh"
                                            ),
                                        ],
                                        name="generator",
                                    )

                                    discriminator = keras.models.Sequential(
                                        [
                                            keras.layers.Conv2D(
                                                32,
                                                kernel_size=3,
                                                strides=2,
                                                padding="same",
                                                activation=keras.layers.LeakyReLU(0.2),
                                                input_shape=[28, 28, D_INP_CHANNELS],
                                            ),
                                            keras.layers.Conv2D(
                                                3,
                                                kernel_size=3,
                                                strides=2,
                                                padding="same",
                                                activation=keras.layers.LeakyReLU(0.2),
                                            ),
                                            keras.layers.Flatten(),
                                            keras.layers.Dense(1, activation="sigmoid"),
                                        ],
                                        name="discriminator",
                                    )
                  </pre>
                                <p>
                                    Plug in the models to the trainer class and train them using the very familiar compile and fit methods:
                                </p>
                                <pre class="brush: python;">
                                    gan = ConditionalGAN(
                                        discriminator=discriminator, generator=generator, latent_dim=CODINGS_SIZE
                                    )
                                    gan.compile(
                                        d_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                                        g_optimizer=keras.optimizers.Adam(learning_rate=0.0001),
                                        loss_fn=keras.losses.BinaryCrossentropy(),
                                    )

                                    history = gan.fit(dataset)
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_4">Variational Auto Encoder</h4>
                  <p>
                    Just provide your encoder and decoder and train your VAE
                    (Sampling is done internally)
                    <br />
                    Data Preparation:
                  </p>
                  <pre class="brush: python;">
                    from pyradox_generative import VAE
                    import numpy as np
                    import tensorflow as tf
                    import tensorflow.keras as keras

                    (x_train, y_train), _ = keras.datasets.mnist.load_data()
                    x_train = x_train.astype(np.float32) / 255
                    x_train = x_train.reshape(-1, 28, 28, 1) * 2.0 - 1.0

                    dataset = tf.data.Dataset.from_tensor_slices(x_train)
                    dataset = dataset.shuffle(1024)
                    dataset = dataset.batch(32, drop_remainder=True).prefetch(1)
                  </pre>
                                <p>Define the encoder and decoder models:</p>
                                <pre class="brush: python;">
                    encoder = keras.models.Sequential(
                        [
                            keras.Input(shape=(28, 28, 1)),
                            keras.layers.Conv2D(32, 3, activation="relu", strides=2, padding="same"),
                            keras.layers.Conv2D(64, 3, activation="relu", strides=2, padding="same"),
                            keras.layers.Flatten(),
                            keras.layers.Dense(16, activation="relu"),
                        ],
                        name="encoder",
                    )

                    decoder = keras.models.Sequential(
                        [
                            keras.Input(shape=(28,)),
                            keras.layers.Dense(7 * 7 * 64, activation="relu"),
                            keras.layers.Reshape((7, 7, 64)),
                            keras.layers.Conv2DTranspose(64, 3, activation="relu", strides=2, padding="same"),
                            keras.layers.Conv2DTranspose(32, 3, activation="relu", strides=2, padding="same"),
                            keras.layers.Conv2DTranspose(1, 3, activation="sigmoid", padding="same"),
                        ],
                        name="decoder",
                    )
                  </pre>
                                <p>
                                    Plug in the models to the trainer class and train them using the very familiar compile and fit methods:
                                </p>
                                <pre class="brush: python;">
                                    vae = VAE(encoder=encoder, decoder=decoder, latent_dim=28)
                                    vae.compile(keras.optimizers.Adam(learning_rate=0.001))
                                    history = vae.fit(dataset)
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_5">Style GAN</h4>
                  <p>
                    Just provide your genrator and discriminator models and
                    train your GAN
                    <br />
                    Data Preparation:
                  </p>
                  <pre class="brush: python;">
                    from pyradox_generative import StyleGAN
                    import numpy as np
                    import tensorflow as tf
                    from functools import partial

                    def resize_image(res, image):
                        # only donwsampling, so use nearest neighbor that is faster to run
                        image = tf.image.resize(
                            image, (res, res), method=tf.image.ResizeMethod.NEAREST_NEIGHBOR
                        )
                        image = tf.cast(image, tf.float32) / 127.5 - 1.0
                        return image


                    def create_dataloader(res):
                        (x_train, y_train), _ = tf.keras.datasets.mnist.load_data()
                        x_train = x_train[:100, :, :]
                        x_train = np.pad(x_train, [(0, 0), (2, 2), (2, 2)], mode="constant")
                        x_train = tf.image.grayscale_to_rgb(tf.expand_dims(x_train, axis=3), name=None)
                        x_train = tf.data.Dataset.from_tensor_slices(x_train)

                        batch_size = 32
                        dl = x_train.map(partial(resize_image, res), num_parallel_calls=tf.data.AUTOTUNE)
                        dl = dl.shuffle(200).batch(batch_size, drop_remainder=True).prefetch(1).repeat()
                        return dl
                  </pre>
                                <p>
                                    Define the model by providing number of filters for each each resolution (log 2):
                                </p>
                                <pre class="brush: python;">
                                    gan = StyleGAN(
                                        target_res=32,
                                        start_res=4,
                                        filter_nums={0: 32, 1: 32, 2: 32, 3: 32, 4: 32, 5: 32},
                                    )
                                    opt_cfg = {"learning_rate": 1e-3, "beta_1": 0.0, "beta_2": 0.99, "epsilon": 1e-8}

                                    start_res_log2 = 2
                                    target_res_log2 = 5
                  </pre>
                                <p>Train the Style GAN:</p>
                                <pre class="brush: python;">
                                    for res_log2 in range(start_res_log2, target_res_log2 + 1):
                                        res = 2 ** res_log2
                                        for phase in ["TRANSITION", "STABLE"]:
                                            if res == 4 and phase == "TRANSITION":
                                                continue

                                            train_dl = create_dataloader(res)

                                            steps = 10

                                            gan.compile(
                                                d_optimizer=tf.keras.optimizers.Adam(**opt_cfg),
                                                g_optimizer=tf.keras.optimizers.Adam(**opt_cfg),
                                                loss_weights={"gradient_penalty": 10, "drift": 0.001},
                                                steps_per_epoch=steps,
                                                res=res,
                                                phase=phase,
                                                run_eagerly=False,
                                            )

                                            print(phase)
                                            history = gan.fit(train_dl, epochs=1, steps_per_epoch=steps)
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <div class="row">
                <div class="col-md-12">
                  <h4 id="line2_6">Cycle GAN</h4>
                  <p>
                    Just provide your genrator and discriminator models and
                    train your GAN
                    <br />
                    Data Preparation:
                  </p>
                  <pre class="brush: python;">
                    import tensorflow_datasets as tfds
                    import tensorflow as tf
                    from tensorflow import keras
                    from pyradox_generative import CycleGAN

                    tfds.disable_progress_bar()
                    autotune = tf.data.AUTOTUNE
                    orig_img_size = (286, 286)
                    input_img_size = (256, 256, 3)


                    def normalize_img(img):
                        img = tf.cast(img, dtype=tf.float32)
                        return (img / 127.5) - 1.0


                    def preprocess_train_image(img, label):
                        img = tf.image.random_flip_left_right(img)
                        img = tf.image.resize(img, [*orig_img_size])
                        img = tf.image.random_crop(img, size=[*input_img_size])
                        img = normalize_img(img)
                        return img


                    def preprocess_test_image(img, label):
                        img = tf.image.resize(img, [input_img_size[0], input_img_size[1]])
                        img = normalize_img(img)
                        return img

                    train_horses, _ = tfds.load(
                        "cycle_gan/horse2zebra", with_info=True, as_supervised=True, split="trainA[:5%]"
                    )
                    train_zebras, _ = tfds.load(
                        "cycle_gan/horse2zebra", with_info=True, as_supervised=True, split="trainB[:5%]"
                    )

                    buffer_size = 256
                    batch_size = 1

                    train_horses = (
                        train_horses.map(preprocess_train_image, num_parallel_calls=autotune)
                        .cache()
                        .shuffle(buffer_size)
                        .batch(batch_size)
                    )
                    train_zebras = (
                        train_zebras.map(preprocess_train_image, num_parallel_calls=autotune)
                        .cache()
                        .shuffle(buffer_size)
                        .batch(batch_size)
                    )
                  </pre>
                                <p>Define the generator and discriminator models:</p>
                                <pre class="brush: python;">
                                    def build_generator(name):
                                        return keras.models.Sequential(
                                            [
                                                keras.layers.Input(shape=input_img_size),
                                                keras.layers.Conv2D(32, 3, activation="relu", padding="same"),
                                                keras.layers.Conv2D(32, 3, activation="relu", padding="same"),
                                                keras.layers.Conv2D(3, 3, activation="tanh", padding="same"),
                                            ],
                                            name=name,
                                        )


                                    def build_discriminator(name):
                                        return keras.models.Sequential(
                                            [
                                                keras.layers.Input(shape=input_img_size),
                                                keras.layers.Conv2D(32, 3, activation="relu", padding="same"),
                                                keras.layers.MaxPooling2D(pool_size=2, strides=2),
                                                keras.layers.Conv2D(32, 3, activation="relu", padding="same"),
                                                keras.layers.MaxPooling2D(pool_size=2, strides=2),
                                                keras.layers.Conv2D(32, 3, activation="relu", padding="same"),
                                                keras.layers.MaxPooling2D(pool_size=2, strides=2),
                                                keras.layers.Conv2D(1, 3, activation="relu", padding="same"),
                                            ],
                                            name=name,
                                        )
                  </pre>
                                <p>
                                    Plug in the models to the trainer class and train them using the very familiar compile and fit methods:
                                </p>
                                <pre class="brush: python;">
                                    gan = CycleGAN(
                                        generator_g=build_generator("gen_G"),
                                        generator_f=build_generator("gen_F"),
                                        discriminator_x=build_discriminator("disc_X"),
                                        discriminator_y=build_discriminator("disc_Y"),
                                    )

                                    gan.compile(
                                        gen_g_optimizer=keras.optimizers.Adam(learning_rate=2e-4, beta_1=0.5),
                                        gen_f_optimizer=keras.optimizers.Adam(learning_rate=2e-4, beta_1=0.5),
                                        disc_x_optimizer=keras.optimizers.Adam(learning_rate=2e-4, beta_1=0.5),
                                        disc_y_optimizer=keras.optimizers.Adam(learning_rate=2e-4, beta_1=0.5),
                                    )

                                    history = gan.fit(
                                        tf.data.Dataset.zip((train_horses, train_zebras)),
                                    )
                                </pre
                  >
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->
              <hr />
            </section>
            <!-- end section -->

            <section id="line3" class="section">
              <div class="row">
                <div class="col-md-12 left-align">
                  <h2 class="dark-text">
                    References
                    <hr />
                  </h2>
                </div>
                <!-- end col -->
              </div>
              <!-- end row -->

              <div class="row">
                <div class="col-md-12">
                  <ol class="reference">
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1406.2661"
                        >Generative Adversarial Networks</a
                      >
                      <a target="_blank" href="https://arxiv.org/abs/1511.06434"
                        >Unsupervised Representation Learning with Deep
                        Convolutional Generative Adversarial Networks</a
                      >
                    </li>
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1411.1784"
                        >Conditional Generative Adversarial Nets</a
                      >
                    </li>
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1701.07875"
                        >Wasserstein GAN</a
                      >
                    </li>
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1704.00028"
                        >Improved Training of Wasserstein GANs</a
                      >
                    </li>
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1906.02691"
                        >An Introduction to Variational Autoencoders</a
                      >
                    </li>
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1812.04948"
                        >A Style-Based Generator Architecture for Generative
                        Adversarial Networks</a
                      >
                    </li>
                    <li>
                      <a target="_blank" href="https://arxiv.org/abs/1703.10593"
                        >Unpaired Image-to-Image Translation using
                        Cycle-Consistent Adversarial Networks</a
                      >
                    </li>
                  </ol>
                </div>
              </div>
              <!-- end row -->
            </section>
            <!-- end section -->
          </div>
          <!-- end col -->
        </div>
        <!--  end row -->
      </div>
      <!--  end container -->
    </div>
    <!-- end wrapper -->

    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/retina.js"></script>
    <script src="../js/jquery.fitvids.js"></script>
    <script src="../js/wow.js"></script>
    <script src="../js/jquery.prettyPhoto.js"></script>

    <!-- CUSTOM PLUGINS -->
    <script src="../js/custom.js"></script>
    <script src="../js/main.js"></script>

    <script src="../js/syntax-highlighter/scripts/shCore.js"></script>
    <script src="../js/syntax-highlighter/scripts/shBrushBash.js"></script>
    <script src="../js/syntax-highlighter/scripts/shBrushPython.js"></script>
  </body>
</html>